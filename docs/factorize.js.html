<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>factorize.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/jkanche/scran.js" target="_blank" class="menu-item" id="repository" >Github repo</a></h2><h3>Classes</h3><ul><li><a href="AggregateAcrossCellsResults.html">AggregateAcrossCellsResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AggregateAcrossCellsResults.html#detected">detected</a></li><li data-type='method' style='display: none;'><a href="AggregateAcrossCellsResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="AggregateAcrossCellsResults.html#numberOfGenes">numberOfGenes</a></li><li data-type='method' style='display: none;'><a href="AggregateAcrossCellsResults.html#numberOfGroups">numberOfGroups</a></li><li data-type='method' style='display: none;'><a href="AggregateAcrossCellsResults.html#sums">sums</a></li></ul></li><li><a href="BuildLabelledReferenceResults.html">BuildLabelledReferenceResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="BuildLabelledReferenceResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="BuildLabelledReferenceResults.html#sharedFeatures">sharedFeatures</a></li></ul></li><li><a href="BuildNeighborSearchIndexResults.html">BuildNeighborSearchIndexResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="BuildNeighborSearchIndexResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="BuildNeighborSearchIndexResults.html#numberOfCells">numberOfCells</a></li><li data-type='method' style='display: none;'><a href="BuildNeighborSearchIndexResults.html#numberOfDims">numberOfDims</a></li></ul></li><li><a href="BuildSnnGraphResults.html">BuildSnnGraphResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="BuildSnnGraphResults.html#free">free</a></li></ul></li><li><a href="ClusterKmeansResults.html">ClusterKmeansResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ClusterKmeansResults.html#clusterCenters">clusterCenters</a></li><li data-type='method' style='display: none;'><a href="ClusterKmeansResults.html#clusters">clusters</a></li><li data-type='method' style='display: none;'><a href="ClusterKmeansResults.html#clusterSizes">clusterSizes</a></li><li data-type='method' style='display: none;'><a href="ClusterKmeansResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="ClusterKmeansResults.html#iterations">iterations</a></li><li data-type='method' style='display: none;'><a href="ClusterKmeansResults.html#numberOfCells">numberOfCells</a></li><li data-type='method' style='display: none;'><a href="ClusterKmeansResults.html#numberOfClusters">numberOfClusters</a></li><li data-type='method' style='display: none;'><a href="ClusterKmeansResults.html#setIterations">setIterations</a></li><li data-type='method' style='display: none;'><a href="ClusterKmeansResults.html#setStatus">setStatus</a></li><li data-type='method' style='display: none;'><a href="ClusterKmeansResults.html#status">status</a></li><li data-type='method' style='display: none;'><a href="ClusterKmeansResults.html#withinClusterSumSquares">withinClusterSumSquares</a></li></ul></li><li><a href="ClusterSnnGraphLeidenResults.html">ClusterSnnGraphLeidenResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ClusterSnnGraphLeidenResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="ClusterSnnGraphLeidenResults.html#membership">membership</a></li><li data-type='method' style='display: none;'><a href="ClusterSnnGraphLeidenResults.html#modularity">modularity</a></li><li data-type='method' style='display: none;'><a href="ClusterSnnGraphLeidenResults.html#setModularity">setModularity</a></li></ul></li><li><a href="ClusterSnnGraphMultiLevelResults.html">ClusterSnnGraphMultiLevelResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ClusterSnnGraphMultiLevelResults.html#best">best</a></li><li data-type='method' style='display: none;'><a href="ClusterSnnGraphMultiLevelResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="ClusterSnnGraphMultiLevelResults.html#membership">membership</a></li><li data-type='method' style='display: none;'><a href="ClusterSnnGraphMultiLevelResults.html#modularity">modularity</a></li><li data-type='method' style='display: none;'><a href="ClusterSnnGraphMultiLevelResults.html#numberOfLevels">numberOfLevels</a></li><li data-type='method' style='display: none;'><a href="ClusterSnnGraphMultiLevelResults.html#setBest">setBest</a></li><li data-type='method' style='display: none;'><a href="ClusterSnnGraphMultiLevelResults.html#setModularity">setModularity</a></li></ul></li><li><a href="ClusterSnnGraphWalktrapResults.html">ClusterSnnGraphWalktrapResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ClusterSnnGraphWalktrapResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="ClusterSnnGraphWalktrapResults.html#membership">membership</a></li><li data-type='method' style='display: none;'><a href="ClusterSnnGraphWalktrapResults.html#modularity">modularity</a></li><li data-type='method' style='display: none;'><a href="ClusterSnnGraphWalktrapResults.html#numberOfMergeSteps">numberOfMergeSteps</a></li><li data-type='method' style='display: none;'><a href="ClusterSnnGraphWalktrapResults.html#setModularity">setModularity</a></li></ul></li><li><a href="FindNearestNeighborsResults.html">FindNearestNeighborsResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="FindNearestNeighborsResults.html#.unserialize">unserialize</a></li><li data-type='method' style='display: none;'><a href="FindNearestNeighborsResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="FindNearestNeighborsResults.html#numberOfCells">numberOfCells</a></li><li data-type='method' style='display: none;'><a href="FindNearestNeighborsResults.html#serialize">serialize</a></li><li data-type='method' style='display: none;'><a href="FindNearestNeighborsResults.html#size">size</a></li></ul></li><li><a href="H5Base.html">H5Base</a><ul class='methods'><li data-type='method' style='display: none;'><a href="H5Base.html#readAttribute">readAttribute</a></li><li data-type='method' style='display: none;'><a href="H5Base.html#writeAttribute">writeAttribute</a></li></ul></li><li><a href="H5DataSet.html">H5DataSet</a><ul class='methods'><li data-type='method' style='display: none;'><a href="H5DataSet.html#load">load</a></li><li data-type='method' style='display: none;'><a href="H5DataSet.html#readAttribute">readAttribute</a></li><li data-type='method' style='display: none;'><a href="H5DataSet.html#write">write</a></li><li data-type='method' style='display: none;'><a href="H5DataSet.html#writeAttribute">writeAttribute</a></li></ul></li><li><a href="H5File.html">H5File</a><ul class='methods'><li data-type='method' style='display: none;'><a href="H5File.html#createDataSet">createDataSet</a></li><li data-type='method' style='display: none;'><a href="H5File.html#createGroup">createGroup</a></li><li data-type='method' style='display: none;'><a href="H5File.html#open">open</a></li><li data-type='method' style='display: none;'><a href="H5File.html#readAttribute">readAttribute</a></li><li data-type='method' style='display: none;'><a href="H5File.html#writeAttribute">writeAttribute</a></li><li data-type='method' style='display: none;'><a href="H5File.html#writeDataSet">writeDataSet</a></li></ul></li><li><a href="H5Group.html">H5Group</a><ul class='methods'><li data-type='method' style='display: none;'><a href="H5Group.html#createDataSet">createDataSet</a></li><li data-type='method' style='display: none;'><a href="H5Group.html#createGroup">createGroup</a></li><li data-type='method' style='display: none;'><a href="H5Group.html#open">open</a></li><li data-type='method' style='display: none;'><a href="H5Group.html#readAttribute">readAttribute</a></li><li data-type='method' style='display: none;'><a href="H5Group.html#writeAttribute">writeAttribute</a></li><li data-type='method' style='display: none;'><a href="H5Group.html#writeDataSet">writeDataSet</a></li></ul></li><li><a href="IntegrateCellLabelsResults.html">IntegrateCellLabelsResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="IntegrateCellLabelsResults.html#fineTuningDelta">fineTuningDelta</a></li><li data-type='method' style='display: none;'><a href="IntegrateCellLabelsResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="IntegrateCellLabelsResults.html#numberOfCells">numberOfCells</a></li><li data-type='method' style='display: none;'><a href="IntegrateCellLabelsResults.html#numberOfReferences">numberOfReferences</a></li><li data-type='method' style='display: none;'><a href="IntegrateCellLabelsResults.html#predictedReferences">predictedReferences</a></li><li data-type='method' style='display: none;'><a href="IntegrateCellLabelsResults.html#scoresForCell">scoresForCell</a></li><li data-type='method' style='display: none;'><a href="IntegrateCellLabelsResults.html#scoresForReference">scoresForReference</a></li></ul></li><li><a href="IntegrateLabelledReferencesResults.html">IntegrateLabelledReferencesResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="IntegrateLabelledReferencesResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="IntegrateLabelledReferencesResults.html#numberOfReferences">numberOfReferences</a></li></ul></li><li><a href="LabelCellsResults.html">LabelCellsResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="LabelCellsResults.html#fineTuningDelta">fineTuningDelta</a></li><li data-type='method' style='display: none;'><a href="LabelCellsResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="LabelCellsResults.html#numberOfCells">numberOfCells</a></li><li data-type='method' style='display: none;'><a href="LabelCellsResults.html#numberOfLabels">numberOfLabels</a></li><li data-type='method' style='display: none;'><a href="LabelCellsResults.html#predictedLabels">predictedLabels</a></li><li data-type='method' style='display: none;'><a href="LabelCellsResults.html#scoresForCell">scoresForCell</a></li><li data-type='method' style='display: none;'><a href="LabelCellsResults.html#scoresForLabel">scoresForLabel</a></li></ul></li><li><a href="LoadLabelledReferenceResults.html">LoadLabelledReferenceResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="LoadLabelledReferenceResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="LoadLabelledReferenceResults.html#numberOfFeatures">numberOfFeatures</a></li><li data-type='method' style='display: none;'><a href="LoadLabelledReferenceResults.html#numberOfLabels">numberOfLabels</a></li><li data-type='method' style='display: none;'><a href="LoadLabelledReferenceResults.html#numberOfSamples">numberOfSamples</a></li></ul></li><li><a href="ModelGeneVariancesResults.html">ModelGeneVariancesResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ModelGeneVariancesResults.html#fitted">fitted</a></li><li data-type='method' style='display: none;'><a href="ModelGeneVariancesResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="ModelGeneVariancesResults.html#means">means</a></li><li data-type='method' style='display: none;'><a href="ModelGeneVariancesResults.html#numberOfBlocks">numberOfBlocks</a></li><li data-type='method' style='display: none;'><a href="ModelGeneVariancesResults.html#residuals">residuals</a></li><li data-type='method' style='display: none;'><a href="ModelGeneVariancesResults.html#variances">variances</a></li></ul></li><li><a href="MultiMatrix.html">MultiMatrix</a><ul class='methods'><li data-type='method' style='display: none;'><a href="MultiMatrix.html#add">add</a></li><li data-type='method' style='display: none;'><a href="MultiMatrix.html#available">available</a></li><li data-type='method' style='display: none;'><a href="MultiMatrix.html#clone">clone</a></li><li data-type='method' style='display: none;'><a href="MultiMatrix.html#free">free</a></li><li data-type='method' style='display: none;'><a href="MultiMatrix.html#get">get</a></li><li data-type='method' style='display: none;'><a href="MultiMatrix.html#has">has</a></li><li data-type='method' style='display: none;'><a href="MultiMatrix.html#numberOfColumns">numberOfColumns</a></li><li data-type='method' style='display: none;'><a href="MultiMatrix.html#remove">remove</a></li><li data-type='method' style='display: none;'><a href="MultiMatrix.html#rename">rename</a></li></ul></li><li><a href="PerCellAdtQcMetricsResults.html">PerCellAdtQcMetricsResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="PerCellAdtQcMetricsResults.html#detected">detected</a></li><li data-type='method' style='display: none;'><a href="PerCellAdtQcMetricsResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="PerCellAdtQcMetricsResults.html#numberOfCells">numberOfCells</a></li><li data-type='method' style='display: none;'><a href="PerCellAdtQcMetricsResults.html#numberOfSubsets">numberOfSubsets</a></li><li data-type='method' style='display: none;'><a href="PerCellAdtQcMetricsResults.html#subsetTotals">subsetTotals</a></li><li data-type='method' style='display: none;'><a href="PerCellAdtQcMetricsResults.html#sums">sums</a></li></ul></li><li><a href="PerCellCrisprQcMetricsResults.html">PerCellCrisprQcMetricsResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="PerCellCrisprQcMetricsResults.html#detected">detected</a></li><li data-type='method' style='display: none;'><a href="PerCellCrisprQcMetricsResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="PerCellCrisprQcMetricsResults.html#maxIndex">maxIndex</a></li><li data-type='method' style='display: none;'><a href="PerCellCrisprQcMetricsResults.html#maxProportions">maxProportions</a></li><li data-type='method' style='display: none;'><a href="PerCellCrisprQcMetricsResults.html#numberOfCells">numberOfCells</a></li><li data-type='method' style='display: none;'><a href="PerCellCrisprQcMetricsResults.html#sums">sums</a></li></ul></li><li><a href="PerCellRnaQcMetricsResults.html">PerCellRnaQcMetricsResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="PerCellRnaQcMetricsResults.html#detected">detected</a></li><li data-type='method' style='display: none;'><a href="PerCellRnaQcMetricsResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="PerCellRnaQcMetricsResults.html#numberOfCells">numberOfCells</a></li><li data-type='method' style='display: none;'><a href="PerCellRnaQcMetricsResults.html#numberOfSubsets">numberOfSubsets</a></li><li data-type='method' style='display: none;'><a href="PerCellRnaQcMetricsResults.html#subsetProportions">subsetProportions</a></li><li data-type='method' style='display: none;'><a href="PerCellRnaQcMetricsResults.html#sums">sums</a></li></ul></li><li><a href="RdsBooleanVector.html">RdsBooleanVector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RdsBooleanVector.html#attribute">attribute</a></li><li data-type='method' style='display: none;'><a href="RdsBooleanVector.html#attributeNames">attributeNames</a></li><li data-type='method' style='display: none;'><a href="RdsBooleanVector.html#findAttribute">findAttribute</a></li><li data-type='method' style='display: none;'><a href="RdsBooleanVector.html#free">free</a></li><li data-type='method' style='display: none;'><a href="RdsBooleanVector.html#length">length</a></li><li data-type='method' style='display: none;'><a href="RdsBooleanVector.html#type">type</a></li><li data-type='method' style='display: none;'><a href="RdsBooleanVector.html#values">values</a></li></ul></li><li><a href="RdsDetails.html">RdsDetails</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RdsDetails.html#formatVersion">formatVersion</a></li><li data-type='method' style='display: none;'><a href="RdsDetails.html#free">free</a></li><li data-type='method' style='display: none;'><a href="RdsDetails.html#readerVersion">readerVersion</a></li><li data-type='method' style='display: none;'><a href="RdsDetails.html#value">value</a></li><li data-type='method' style='display: none;'><a href="RdsDetails.html#writerVersion">writerVersion</a></li></ul></li><li><a href="RdsDoubleVector.html">RdsDoubleVector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RdsDoubleVector.html#attribute">attribute</a></li><li data-type='method' style='display: none;'><a href="RdsDoubleVector.html#attributeNames">attributeNames</a></li><li data-type='method' style='display: none;'><a href="RdsDoubleVector.html#findAttribute">findAttribute</a></li><li data-type='method' style='display: none;'><a href="RdsDoubleVector.html#free">free</a></li><li data-type='method' style='display: none;'><a href="RdsDoubleVector.html#length">length</a></li><li data-type='method' style='display: none;'><a href="RdsDoubleVector.html#type">type</a></li><li data-type='method' style='display: none;'><a href="RdsDoubleVector.html#values">values</a></li></ul></li><li><a href="RdsGenericVector.html">RdsGenericVector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RdsGenericVector.html#attribute">attribute</a></li><li data-type='method' style='display: none;'><a href="RdsGenericVector.html#attributeNames">attributeNames</a></li><li data-type='method' style='display: none;'><a href="RdsGenericVector.html#findAttribute">findAttribute</a></li><li data-type='method' style='display: none;'><a href="RdsGenericVector.html#free">free</a></li><li data-type='method' style='display: none;'><a href="RdsGenericVector.html#length">length</a></li><li data-type='method' style='display: none;'><a href="RdsGenericVector.html#load">load</a></li><li data-type='method' style='display: none;'><a href="RdsGenericVector.html#type">type</a></li></ul></li><li><a href="RdsIntegerVector.html">RdsIntegerVector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RdsIntegerVector.html#attribute">attribute</a></li><li data-type='method' style='display: none;'><a href="RdsIntegerVector.html#attributeNames">attributeNames</a></li><li data-type='method' style='display: none;'><a href="RdsIntegerVector.html#findAttribute">findAttribute</a></li><li data-type='method' style='display: none;'><a href="RdsIntegerVector.html#free">free</a></li><li data-type='method' style='display: none;'><a href="RdsIntegerVector.html#length">length</a></li><li data-type='method' style='display: none;'><a href="RdsIntegerVector.html#type">type</a></li><li data-type='method' style='display: none;'><a href="RdsIntegerVector.html#values">values</a></li></ul></li><li><a href="RdsNull.html">RdsNull</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RdsNull.html#free">free</a></li><li data-type='method' style='display: none;'><a href="RdsNull.html#type">type</a></li></ul></li><li><a href="RdsObject.html">RdsObject</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RdsObject.html#free">free</a></li><li data-type='method' style='display: none;'><a href="RdsObject.html#type">type</a></li></ul></li><li><a href="RdsS4Object.html">RdsS4Object</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RdsS4Object.html#attribute">attribute</a></li><li data-type='method' style='display: none;'><a href="RdsS4Object.html#attributeNames">attributeNames</a></li><li data-type='method' style='display: none;'><a href="RdsS4Object.html#className">className</a></li><li data-type='method' style='display: none;'><a href="RdsS4Object.html#findAttribute">findAttribute</a></li><li data-type='method' style='display: none;'><a href="RdsS4Object.html#free">free</a></li><li data-type='method' style='display: none;'><a href="RdsS4Object.html#packageName">packageName</a></li><li data-type='method' style='display: none;'><a href="RdsS4Object.html#type">type</a></li></ul></li><li><a href="RdsStringVector.html">RdsStringVector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RdsStringVector.html#attribute">attribute</a></li><li data-type='method' style='display: none;'><a href="RdsStringVector.html#attributeNames">attributeNames</a></li><li data-type='method' style='display: none;'><a href="RdsStringVector.html#findAttribute">findAttribute</a></li><li data-type='method' style='display: none;'><a href="RdsStringVector.html#free">free</a></li><li data-type='method' style='display: none;'><a href="RdsStringVector.html#length">length</a></li><li data-type='method' style='display: none;'><a href="RdsStringVector.html#type">type</a></li><li data-type='method' style='display: none;'><a href="RdsStringVector.html#values">values</a></li></ul></li><li><a href="RdsVector.html">RdsVector</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RdsVector.html#attribute">attribute</a></li><li data-type='method' style='display: none;'><a href="RdsVector.html#attributeNames">attributeNames</a></li><li data-type='method' style='display: none;'><a href="RdsVector.html#findAttribute">findAttribute</a></li><li data-type='method' style='display: none;'><a href="RdsVector.html#free">free</a></li><li data-type='method' style='display: none;'><a href="RdsVector.html#length">length</a></li><li data-type='method' style='display: none;'><a href="RdsVector.html#type">type</a></li></ul></li><li><a href="RunPcaResults.html">RunPcaResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RunPcaResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="RunPcaResults.html#numberOfCells">numberOfCells</a></li><li data-type='method' style='display: none;'><a href="RunPcaResults.html#numberOfPCs">numberOfPCs</a></li><li data-type='method' style='display: none;'><a href="RunPcaResults.html#principalComponents">principalComponents</a></li><li data-type='method' style='display: none;'><a href="RunPcaResults.html#setTotalVariance">setTotalVariance</a></li><li data-type='method' style='display: none;'><a href="RunPcaResults.html#totalVariance">totalVariance</a></li><li data-type='method' style='display: none;'><a href="RunPcaResults.html#varianceExplained">varianceExplained</a></li></ul></li><li><a href="ScoreMarkersResults.html">ScoreMarkersResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ScoreMarkersResults.html#auc">auc</a></li><li data-type='method' style='display: none;'><a href="ScoreMarkersResults.html#cohen">cohen</a></li><li data-type='method' style='display: none;'><a href="ScoreMarkersResults.html#deltaDetected">deltaDetected</a></li><li data-type='method' style='display: none;'><a href="ScoreMarkersResults.html#detected">detected</a></li><li data-type='method' style='display: none;'><a href="ScoreMarkersResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="ScoreMarkersResults.html#lfc">lfc</a></li><li data-type='method' style='display: none;'><a href="ScoreMarkersResults.html#means">means</a></li><li data-type='method' style='display: none;'><a href="ScoreMarkersResults.html#numberOfGroups">numberOfGroups</a></li></ul></li><li><a href="ScranMatrix.html">ScranMatrix</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ScranMatrix.html#.createDenseMatrix">createDenseMatrix</a></li><li data-type='method' style='display: none;'><a href="ScranMatrix.html#clone">clone</a></li><li data-type='method' style='display: none;'><a href="ScranMatrix.html#column">column</a></li><li data-type='method' style='display: none;'><a href="ScranMatrix.html#free">free</a></li><li data-type='method' style='display: none;'><a href="ScranMatrix.html#isSparse">isSparse</a></li><li data-type='method' style='display: none;'><a href="ScranMatrix.html#numberOfColumns">numberOfColumns</a></li><li data-type='method' style='display: none;'><a href="ScranMatrix.html#numberOfRows">numberOfRows</a></li><li data-type='method' style='display: none;'><a href="ScranMatrix.html#row">row</a></li></ul></li><li><a href="SuggestAdtQcFiltersResults.html">SuggestAdtQcFiltersResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SuggestAdtQcFiltersResults.html#filter">filter</a></li><li data-type='method' style='display: none;'><a href="SuggestAdtQcFiltersResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="SuggestAdtQcFiltersResults.html#numberOfBlocks">numberOfBlocks</a></li><li data-type='method' style='display: none;'><a href="SuggestAdtQcFiltersResults.html#numberOfSubsets">numberOfSubsets</a></li><li data-type='method' style='display: none;'><a href="SuggestAdtQcFiltersResults.html#thresholdsDetected">thresholdsDetected</a></li><li data-type='method' style='display: none;'><a href="SuggestAdtQcFiltersResults.html#thresholdsSubsetTotals">thresholdsSubsetTotals</a></li></ul></li><li><a href="SuggestCrisprQcFiltersResults.html">SuggestCrisprQcFiltersResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SuggestCrisprQcFiltersResults.html#filter">filter</a></li><li data-type='method' style='display: none;'><a href="SuggestCrisprQcFiltersResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="SuggestCrisprQcFiltersResults.html#numberOfBlocks">numberOfBlocks</a></li><li data-type='method' style='display: none;'><a href="SuggestCrisprQcFiltersResults.html#thresholdsMaxCount">thresholdsMaxCount</a></li></ul></li><li><a href="SuggestRnaQcFiltersResults.html">SuggestRnaQcFiltersResults</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SuggestRnaQcFiltersResults.html#filter">filter</a></li><li data-type='method' style='display: none;'><a href="SuggestRnaQcFiltersResults.html#free">free</a></li><li data-type='method' style='display: none;'><a href="SuggestRnaQcFiltersResults.html#numberOfBlocks">numberOfBlocks</a></li><li data-type='method' style='display: none;'><a href="SuggestRnaQcFiltersResults.html#numberOfSubsets">numberOfSubsets</a></li><li data-type='method' style='display: none;'><a href="SuggestRnaQcFiltersResults.html#thresholdsDetected">thresholdsDetected</a></li><li data-type='method' style='display: none;'><a href="SuggestRnaQcFiltersResults.html#thresholdsSubsetProportions">thresholdsSubsetProportions</a></li><li data-type='method' style='display: none;'><a href="SuggestRnaQcFiltersResults.html#thresholdsSums">thresholdsSums</a></li></ul></li><li><a href="TsneStatus.html">TsneStatus</a><ul class='methods'><li data-type='method' style='display: none;'><a href="TsneStatus.html#clone">clone</a></li><li data-type='method' style='display: none;'><a href="TsneStatus.html#extractCoordinates">extractCoordinates</a></li><li data-type='method' style='display: none;'><a href="TsneStatus.html#free">free</a></li><li data-type='method' style='display: none;'><a href="TsneStatus.html#iterations">iterations</a></li><li data-type='method' style='display: none;'><a href="TsneStatus.html#numberOfCells">numberOfCells</a></li><li data-type='method' style='display: none;'><a href="TsneStatus.html#run">run</a></li></ul></li><li><a href="UmapStatus.html">UmapStatus</a><ul class='methods'><li data-type='method' style='display: none;'><a href="UmapStatus.html#clone">clone</a></li><li data-type='method' style='display: none;'><a href="UmapStatus.html#currentEpoch">currentEpoch</a></li><li data-type='method' style='display: none;'><a href="UmapStatus.html#extractCoordinates">extractCoordinates</a></li><li data-type='method' style='display: none;'><a href="UmapStatus.html#free">free</a></li><li data-type='method' style='display: none;'><a href="UmapStatus.html#numberOfCells">numberOfCells</a></li><li data-type='method' style='display: none;'><a href="UmapStatus.html#run">run</a></li><li data-type='method' style='display: none;'><a href="UmapStatus.html#totalEpochs">totalEpochs</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#aggregateAcrossCells">aggregateAcrossCells</a></li><li><a href="global.html#buildLabelledReference">buildLabelledReference</a></li><li><a href="global.html#buildNeighborSearchIndex">buildNeighborSearchIndex</a></li><li><a href="global.html#buildSnnGraph">buildSnnGraph</a></li><li><a href="global.html#cbind">cbind</a></li><li><a href="global.html#cbindWithNames">cbindWithNames</a></li><li><a href="global.html#centerSizeFactors">centerSizeFactors</a></li><li><a href="global.html#chooseHvgs">chooseHvgs</a></li><li><a href="global.html#chooseTemporaryPath">chooseTemporaryPath</a></li><li><a href="global.html#clusterKmeans">clusterKmeans</a></li><li><a href="global.html#clusterSnnGraph">clusterSnnGraph</a></li><li><a href="global.html#computeTopThreshold">computeTopThreshold</a></li><li><a href="global.html#convertToFactor">convertToFactor</a></li><li><a href="global.html#createBigUint64WasmArray">createBigUint64WasmArray</a></li><li><a href="global.html#createBlock">createBlock</a></li><li><a href="global.html#createFloat64WasmArray">createFloat64WasmArray</a></li><li><a href="global.html#createInt32WasmArray">createInt32WasmArray</a></li><li><a href="global.html#createNewHdf5File">createNewHdf5File</a></li><li><a href="global.html#createUint8WasmArray">createUint8WasmArray</a></li><li><a href="global.html#delayedArithmetic">delayedArithmetic</a></li><li><a href="global.html#delayedMath">delayedMath</a></li><li><a href="global.html#dropUnusedLevels">dropUnusedLevels</a></li><li><a href="global.html#emptyClusterSnnGraphResults">emptyClusterSnnGraphResults</a></li><li><a href="global.html#emptyPerCellAdtQcMetricsResults">emptyPerCellAdtQcMetricsResults</a></li><li><a href="global.html#emptyPerCellCrisprQcMetricsResults">emptyPerCellCrisprQcMetricsResults</a></li><li><a href="global.html#emptyPerCellRnaQcMetricsResults">emptyPerCellRnaQcMetricsResults</a></li><li><a href="global.html#emptySuggestAdtQcFiltersResults">emptySuggestAdtQcFiltersResults</a></li><li><a href="global.html#emptySuggestCrisprQcFiltersResults">emptySuggestCrisprQcFiltersResults</a></li><li><a href="global.html#emptySuggestRnaQcFiltersResults">emptySuggestRnaQcFiltersResults</a></li><li><a href="global.html#existsFile">existsFile</a></li><li><a href="global.html#extractHdf5MatrixDetails">extractHdf5MatrixDetails</a></li><li><a href="global.html#extractHdf5ObjectNames">extractHdf5ObjectNames</a></li><li><a href="global.html#extractMatrixMarketDimensions">extractMatrixMarketDimensions</a></li><li><a href="global.html#filterCells">filterCells</a></li><li><a href="global.html#findNearestNeighbors">findNearestNeighbors</a></li><li><a href="global.html#free">free</a></li><li><a href="global.html#groupedSizeFactors">groupedSizeFactors</a></li><li><a href="global.html#guessFeatures">guessFeatures</a></li><li><a href="global.html#heapSize">heapSize</a></li><li><a href="global.html#hypergeometricTest">hypergeometricTest</a></li><li><a href="global.html#initialize">initialize</a></li><li><a href="global.html#initializeDenseMatrixFromDenseArray">initializeDenseMatrixFromDenseArray</a></li><li><a href="global.html#initializeSparseMatrixFromCompressedVectors">initializeSparseMatrixFromCompressedVectors</a></li><li><a href="global.html#initializeSparseMatrixFromDenseArray">initializeSparseMatrixFromDenseArray</a></li><li><a href="global.html#initializeSparseMatrixFromHdf5">initializeSparseMatrixFromHdf5</a></li><li><a href="global.html#initializeSparseMatrixFromMatrixMarket">initializeSparseMatrixFromMatrixMarket</a></li><li><a href="global.html#initializeSparseMatrixFromRds">initializeSparseMatrixFromRds</a></li><li><a href="global.html#initializeTsne">initializeTsne</a></li><li><a href="global.html#initializeUmap">initializeUmap</a></li><li><a href="global.html#integrateCellLabels">integrateCellLabels</a></li><li><a href="global.html#integrateLabelledReferences">integrateLabelledReferences</a></li><li><a href="global.html#labelCells">labelCells</a></li><li><a href="global.html#loadHdf5Dataset">loadHdf5Dataset</a></li><li><a href="global.html#loadLabelledReferenceFromBuffers">loadLabelledReferenceFromBuffers</a></li><li><a href="global.html#logNormCounts">logNormCounts</a></li><li><a href="global.html#maximumThreads">maximumThreads</a></li><li><a href="global.html#medianSizeFactors">medianSizeFactors</a></li><li><a href="global.html#mnnCorrect">mnnCorrect</a></li><li><a href="global.html#modelGeneVariances">modelGeneVariances</a></li><li><a href="global.html#perCellAdtQcMetrics">perCellAdtQcMetrics</a></li><li><a href="global.html#perCellCrisprQcMetrics">perCellCrisprQcMetrics</a></li><li><a href="global.html#perCellRnaQcMetrics">perCellRnaQcMetrics</a></li><li><a href="global.html#perplexityToNeighbors">perplexityToNeighbors</a></li><li><a href="global.html#possibleCopy">possibleCopy</a></li><li><a href="global.html#quickAdtSizeFactors">quickAdtSizeFactors</a></li><li><a href="global.html#rbind">rbind</a></li><li><a href="global.html#readFile">readFile</a></li><li><a href="global.html#readRds">readRds</a></li><li><a href="global.html#realizeFile">realizeFile</a></li><li><a href="global.html#remapFeatureSets">remapFeatureSets</a></li><li><a href="global.html#removeFile">removeFile</a></li><li><a href="global.html#resetLevels">resetLevels</a></li><li><a href="global.html#runPca">runPca</a></li><li><a href="global.html#runTsne">runTsne</a></li><li><a href="global.html#runUmap">runUmap</a></li><li><a href="global.html#scaleByNeighbors">scaleByNeighbors</a></li><li><a href="global.html#scoreFeatureSet">scoreFeatureSet</a></li><li><a href="global.html#scoreMarkers">scoreMarkers</a></li><li><a href="global.html#splitRows">splitRows</a></li><li><a href="global.html#subsetColumns">subsetColumns</a></li><li><a href="global.html#subsetFactor">subsetFactor</a></li><li><a href="global.html#subsetRows">subsetRows</a></li><li><a href="global.html#suggestAdtQcFilters">suggestAdtQcFilters</a></li><li><a href="global.html#suggestCrisprQcFilters">suggestCrisprQcFilters</a></li><li><a href="global.html#suggestRnaQcFilters">suggestRnaQcFilters</a></li><li><a href="global.html#terminate">terminate</a></li><li><a href="global.html#testFeatureSetEnrichment">testFeatureSetEnrichment</a></li><li><a href="global.html#transpose">transpose</a></li><li><a href="global.html#wasmArraySpace">wasmArraySpace</a></li><li><a href="global.html#writeFile">writeFile</a></li><li><a href="global.html#writeSparseMatrixToHdf5">writeSparseMatrixToHdf5</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">factorize.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import * as wa from "wasmarrays.js";
import * as utils from "./utils.js";

/**
 * Convert an arbitrary array into a R-style factor, with integer indices into an array of levels.
 * This is useful for formatting grouping or blocking vectors for {@linkcode scoreMarkers}, {@linkcode modelGeneVar}, etc.
 *
 * @param {Array|TypedArray} x - Array of values to be converted into a factor.
 * 
 * Note that TypedArray views on Wasm-allocated buffers should only be provided if `buffer` is also provided;
 * otherwise, a Wasm memory allocation may invalidate the view.
 * @param {object} [options={}] - Optional parameters.
 * @param {boolean} [options.asWasmArray=true] - Whether to return an Int32WasmArray instance for the indices.
 * If `false`, an Int32Array is returned instead.
 * Only used if `buffer` is not supplied.
 * @param {?(Int32WasmArray|Int32Array)} [options.buffer=null] - Array in which the output is to be stored.
 * If provided, this should be of length equal to that of `x`.
 * @param {?Array} [options.levels=null] - An existing array of known levels to be matched against `x`.
 * Values in `x` that are not in `levels` are considered to be invalid.
 * If `null`, the levels are automatically inferred from `x`; these will be sorted if all-numeric or all-string.
 * @param {string} [options.action="error"] - Action to take when invalid values (i.e., null, NaNs) are detected in `x`.
 *
 * - `"none"`: the index is silently set to `placeholder`.
 * - `"warn"`: a warning is raised on the first occurrence of an invalid value, and the index is set to `placeholder`.
 * - `"error"`: an error is raised.
 * 
 * @param {number} [options.placeholder=-1] - Placeholder index to use upon detecting invalid values in `x`.
 *
 * @return {object} Object containing:
 *
 * - `ids`: an Int32WasmArray or Int32Array of length equal to `x`, containing the index into `levels` for each cell.
 * - `levels`: an array of unique levels, such that `Array.from(ids).map(i => levels[i])` returns the same contents as `x` (aside from invalid values).
 *   If an input `levels` is supplied, this is returned directly.
 *
 * If `buffer` was supplied, it is used as the value of the `ids` property.
 */
export function convertToFactor(x, { asWasmArray = true, buffer = null, levels = null, action = "error", placeholder = -1 } = {}) {
    let local_buffer;

    let failure;
    if (action == "warn") {
        let warned = false;
        failure = () => {
            if (!warned) {
                console.warn ("replacing invalid values with the placeholder index '" + String(placeholder) + "'");
                warned = true;
            }
        };
    } else if (action == "none") {
        failure = () => {};
    } else if (action == "error") {
        failure = () => {
            throw new Error("detected invalid value (e.g., null, NaN) in 'x'");
        };
    } else {
        throw new Error("unknown action '" + action + "' for handling invalid entries");
    }

    try {
        if (buffer == null) {
            local_buffer = (asWasmArray ? utils.createInt32WasmArray(x.length) : new Int32Array(x.length));
            buffer = local_buffer;
        } else {
            if (buffer.length !== x.length) {
                throw new Error("'buffer' should have length equal to that of 'x'");
            }
            asWasmArray = buffer instanceof wa.Int32WasmArray;
        }

        let barr = (asWasmArray ? buffer.array() : buffer); // no allocations from this point onwards!
        let mapping = new Map;

        if (levels == null) {
            levels = [];
            for (var i = 0; i &lt; x.length; i++) {
                let y = x[i];
                if (y == null || (typeof y == "number" &amp;&amp; !Number.isFinite(y))) {
                    failure();
                    barr[i] = placeholder;
                    continue;
                }

                let existing = mapping.get(y);
                if (typeof existing == "undefined") {
                    let n = levels.length;
                    mapping.set(y, n);
                    levels.push(y);
                    barr[i] = n;
                } else {
                    barr[i] = existing;
                }
            }

            // Sorting them by default, to make life nicer.
            if (levels.every(x => typeof x == "string")) {
                let oldlevels = levels.slice();
                levels.sort();
                resetLevels({ ids: buffer, levels: oldlevels }, levels);
            } else if (levels.every(x => typeof x == "number")) {
                let oldlevels = levels.slice();
                levels.sort((a, b) => a - b);
                resetLevels({ ids: buffer, levels: oldlevels }, levels);
            }

        } else {
            for (var l = 0; l &lt; levels.length; l++) {
                mapping.set(levels[l], l);
            }

            for (var i = 0; i &lt; x.length; i++) {
                let y = x[i];
                let existing = mapping.get(y);
                if (typeof existing == "undefined") {
                    failure();
                    barr[i] = placeholder;
                } else {
                    barr[i] = existing;
                }
            }
        }

    } catch (e) {
        if (local_buffer instanceof wa.WasmArray) {
            utils.free(local_buffer);
        }
        throw e;
    }

    return {
        ids: buffer,
        levels: levels
    };
}

// Back-compatible renaming.
export function factorize(x, options = {}) {
    return convertToFactor(x, options);
}

/**
 * Reindex the factor indices to remove unused levels.
 * This is done by adjusting the indices such that every index from `[0, N)` is represented at least once, where `N` is the number of (used) levels.
 *
 * @param {Int32WasmArray|TypedArray|Array} x - Array of factor indices such as that produced by {@linkcode convertToFactor}. 
 *
 * @return {Array} `x` is modified in place to remove unused levels.
 *
 * An array (denoted here as `y`) is returned that represents the mapping between the original and modified IDs,
 * i.e., running `x.map(i => y[i])` will recover the input `x`.
 * This is most commonly used to create a new array of levels, i.e., `y.map(i => old_levels[i])` will drop the unused levels. 
 */
export function dropUnusedLevels(x) {
    if (x instanceof wa.WasmArray) {
        // No more wasm allocations past this point!
        x = x.array();
    }

    let uniq = new Set(x);
    let uniq_arr = Array.from(uniq).sort();
    let mapping = {};
    uniq_arr.forEach((y, i) => { mapping[y] = i; });

    x.forEach((y, i) => {
        x[i] = mapping[y];
    });

    return uniq_arr;
}

/**
 * Change the levels of a factor, updating the indices appropriately.
 *
 * @param {object} x - Factor object produced by {@linkcode convertToFactor}.
 * @param {Array} newLevels - Array of new levels.
 * This should be a superset of `x.levels`.
 * @param {object} [options={}] - Optional parameters.
 * @param {string} [options.action="error"] - Action to take when `newLevels` is not a superset of `x.levels`.
 * This can be `"error"`, `"warn"` or `"none"`.
 * @param {number} [options.placeholder=-1] - Placeholder index corresponding to invalid values of `x.ids`.
 * Any placeholders in `x.ids` will be preserved on function return.
 * Additionally, if entries of `x.ids` refer to entries of `x.levels` that are missing in `newLevels`, they will be set to the placeholder value on function return;
 * this is only relevant if `action = "warn"` or `"none"`.
 *
 * @return `x` is modified by reference such that `x.levels` is set to `newLevels`.
 * `x.ids` is updated so that the indices now refer to the appropriate value in `newLevels`.
 */
export function resetLevels(x, newLevels, { action = "error", placeholder = -1 } = {}) {
    let mapping = new Map;
    for (var i = 0; i &lt; newLevels.length; i++) {
        mapping.set(newLevels[i], i);
    }

    let failure;
    if (action == "warn") {
        let warned = false;
        failure = () => {
            if (!warned) {
                console.warn ("replacing missing levels with the placeholder index '" + String(placeholder) + "'");
                warned = true;
            }
        };
    } else if (action == "none") {
        failure = () => {};
    } else if (action == "error") {
        failure = () => {
            throw new Error("detected level in 'x.levels' that is missing from 'newLevels'");
        };
    } else {
        throw new Error("unknown action '" + action + "' for handling missing levels");
    }

    let oldLevels = x.levels;
    let conversion = new Array(oldLevels.length);
    let warned = false;
    for (var i = 0; i &lt; oldLevels.length; i++) {
        let found = mapping.get(oldLevels[i]);
        if (typeof found == "undefined") {
            failure();
            conversion[i] = placeholder;
        } else {
            conversion[i] = found;
        }
    }
    x.levels = newLevels;

    let target = x.ids;
    if (target instanceof wa.WasmArray) {
        // No more wasm allocations past this point!
        target = target.array();
    }
    target.forEach((y, i) => {
        if (y !== placeholder) {
            target[i] = conversion[y];
        }
    });
}

/**
 * Subset a factor, possibly also dropping its unused levels.
 * This is typically based on the same filtering vector as {@linkcode filterCells}.
 *
 * @param {object} x - An object representing a factor, containing the following properties:
 *
 * - `ids`: An Int32Array or Int32WasmArray of integer indices.
 * - `levels`: An array of levels that can be indexed by entries of `ids`.
 *
 * This is typically produced by {@linkcode convertToFactor}. 
 * @param {(Array|TypedArray|WasmArray)} subset - Array specifying the subset to retain or filter out, depending on `filter`.
 *
 * If `filter = null`, the array is expected to contain integer indices specifying the entries in `x` to retain.
 * The ordering of indices in `subset` will be respected in the subsetted array.
 *
 * If `filter = true`, the array should be of length equal to that of `x`.
 * Each value is interpreted as a boolean and, if truthy, indicates that the corresponding entry of `x` should be filtered out.
 *
 * If `filter = false`, the array should be of length equal to that of `x`.
 * Each value is interpreted as a boolean and, if truthy, indicates that the corresponding entry of `x` should be retained.
 *
 * Note that TypedArray views on Wasm-allocated buffers should only be provided if `buffer` is also provided;
 * otherwise, a Wasm memory allocation may invalidate the view.
 * @param {object} [options={}] - Optional parameters.
 * @param {boolean} [options.drop=true] - Whether to drop unused levels in the output, see {@linkcode dropUnusedLevels}.
 * @param {?boolean} [options.filter=null] - Whether to retain truthy or falsey values in a `subset` boolean filter.
 * If `null`, `subset` should instead contain the indices of elements to retain.
 * @param {?(Int32Array|Int32WasmArray)} [options.buffer=null] - Array in which the output is to be stored, of the same type as `x.ids`.
 * If provided, this should be of length equal to `subset`, if `filter = null`;
 * the number of truthy elements in `subset`, if `filter = false`;
 * or the number of falsey elements in `subset`, if `filter = true`.
 *
 * @return {object} An object like `x`, containing:
 *
 * - `ids`: An Int32Array or Int32WasmArray of integer indices, subsetted from those in `x.ids`.
 * - `levels`: Array of levels that can be indexed by entries of the output `ids`.
 *   If `drop = true`, this may be a subset of `x.levels` where every entry is represented at least once in the output `ids`.
 *
 * If `buffer` is supplied, the returned `ids` will be set to `buffer`.
 */
export function subsetFactor(x, subset, { drop = true, filter = null, buffer = null } = {}) {
    let output = { ids: null, levels: x.levels };

    if (x.ids instanceof wa.WasmArray) {
        output.ids = wa.subsetWasmArray(x.ids, subset, { filter, buffer });
    } else {
        let n = wa.checkSubsetLength(subset, filter, x.length, "x");
        if (buffer == null) {
            buffer = new x.ids.constructor(n);
        }
        wa.fillSubset(subset, filter, x.ids, buffer);
        output.ids = buffer;
    }

    if (drop) {
        let remapping = dropUnusedLevels(output.ids);
        output.levels = remapping.map(i => x.levels[i]);
    }
    return output;
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a> on Tue Jul 25 2023 16:16:11 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
