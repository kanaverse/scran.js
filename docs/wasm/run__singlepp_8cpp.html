<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran.js: run_singlepp.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran.js
   </div>
   <div id="projectbrief">Compiling scran&#39;s C++ library to WebAssembly</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">run_singlepp.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;emscripten/bind.h&gt;</code><br />
<code>#include &quot;<a class="el" href="NumericMatrix_8h_source.html">NumericMatrix.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utils_8h_source.html">utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="parallel_8h_source.html">parallel.h</a>&quot;</code><br />
<code>#include &quot;singlepp/singlepp.hpp&quot;</code><br />
<code>#include &quot;singlepp/load_references.hpp&quot;</code><br />
<code>#include &quot;tatami/tatami.hpp&quot;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;memory&gt;</code><br />
<code>#include &lt;cstdint&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for run_singlepp.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="run__singlepp_8cpp__incl.png" border="0" usemap="#arun__singlepp_8cpp" alt=""/></div>
<map name="arun__singlepp_8cpp" id="arun__singlepp_8cpp">
<area shape="rect" title=" " alt="" coords="383,5,501,32"/>
<area shape="rect" title=" " alt="" coords="5,80,129,107"/>
<area shape="rect" href="NumericMatrix_8h.html" title="Javascript wrapper for a numeric matrix." alt="" coords="205,80,321,107"/>
<area shape="rect" href="parallel_8h.html" title=" " alt="" coords="112,155,185,181"/>
<area shape="rect" href="utils_8h.html" title=" " alt="" coords="447,80,503,107"/>
<area shape="rect" title=" " alt="" coords="342,155,401,181"/>
<area shape="rect" title=" " alt="" coords="425,155,486,181"/>
<area shape="rect" title=" " alt="" coords="527,80,674,107"/>
<area shape="rect" title=" " alt="" coords="699,80,889,107"/>
<area shape="rect" title=" " alt="" coords="914,80,1037,107"/>
<area shape="rect" title=" " alt="" coords="1061,80,1129,107"/>
<area shape="rect" title=" " alt="" coords="209,155,317,181"/>
<area shape="rect" title=" " alt="" coords="510,155,569,181"/>
<area shape="rect" title=" " alt="" coords="593,155,665,181"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePPReference.html">SinglePPReference</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A reference dataset for <b>singlepp</b> annotation.  <a href="classSinglePPReference.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBuiltSinglePPReference.html">BuiltSinglePPReference</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A built reference dataset for <b>singlepp</b> annotation.  <a href="classBuiltSinglePPReference.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratedSinglePPReferences.html">IntegratedSinglePPReferences</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrated references for <b>singlepp</b> annotation.  <a href="classIntegratedSinglePPReferences.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7660d0a2103fd156b4de21c789b22db2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="run__singlepp_8cpp.html#a7660d0a2103fd156b4de21c789b22db2">SINGLEPP_USE_ZLIB</a></td></tr>
<tr class="separator:a7660d0a2103fd156b4de21c789b22db2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5c22e638037333a0544e8176c25ac126"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSinglePPReference.html">SinglePPReference</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="run__singlepp_8cpp.html#a5c22e638037333a0544e8176c25ac126">load_singlepp_reference</a> (uintptr_t labels_buffer, size_t labels_len, uintptr_t markers_buffer, size_t markers_len, uintptr_t rankings_buffer, size_t rankings_len)</td></tr>
<tr class="separator:a5c22e638037333a0544e8176c25ac126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b596536ba8ab3238c77a32832c753d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBuiltSinglePPReference.html">BuiltSinglePPReference</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="run__singlepp_8cpp.html#a9b596536ba8ab3238c77a32832c753d0">build_singlepp_reference</a> (size_t nfeatures, uintptr_t mat_id, const <a class="el" href="classSinglePPReference.html">SinglePPReference</a> &amp;ref, uintptr_t ref_id, int top, int nthreads)</td></tr>
<tr class="separator:a9b596536ba8ab3238c77a32832c753d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a049321a0e89b028242b1aa3ad09bcc03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="run__singlepp_8cpp.html#a049321a0e89b028242b1aa3ad09bcc03">run_singlepp</a> (const <a class="el" href="structNumericMatrix.html">NumericMatrix</a> &amp;mat, const <a class="el" href="classBuiltSinglePPReference.html">BuiltSinglePPReference</a> &amp;built, double quantile, uintptr_t output, int nthreads)</td></tr>
<tr class="separator:a049321a0e89b028242b1aa3ad09bcc03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fcfba933b7bd26813e73a3089eb59af"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntegratedSinglePPReferences.html">IntegratedSinglePPReferences</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="run__singlepp_8cpp.html#a0fcfba933b7bd26813e73a3089eb59af">integrate_singlepp_references</a> (size_t nfeatures, uintptr_t mat_id, size_t nref, uintptr_t refs, uintptr_t ref_ids, uintptr_t built, int nthreads)</td></tr>
<tr class="separator:a0fcfba933b7bd26813e73a3089eb59af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1507cbb26d4b4da36583bbe7821dda17"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="run__singlepp_8cpp.html#a1507cbb26d4b4da36583bbe7821dda17">integrate_singlepp</a> (const <a class="el" href="structNumericMatrix.html">NumericMatrix</a> &amp;mat, uintptr_t assigned, const <a class="el" href="classIntegratedSinglePPReferences.html">IntegratedSinglePPReferences</a> &amp;integrated, double quantile, uintptr_t output, int nthreads)</td></tr>
<tr class="separator:a1507cbb26d4b4da36583bbe7821dda17"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a7660d0a2103fd156b4de21c789b22db2" name="a7660d0a2103fd156b4de21c789b22db2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7660d0a2103fd156b4de21c789b22db2">&#9670;&nbsp;</a></span>SINGLEPP_USE_ZLIB</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SINGLEPP_USE_ZLIB</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9b596536ba8ab3238c77a32832c753d0" name="a9b596536ba8ab3238c77a32832c753d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b596536ba8ab3238c77a32832c753d0">&#9670;&nbsp;</a></span>build_singlepp_reference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBuiltSinglePPReference.html">BuiltSinglePPReference</a> build_singlepp_reference </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nfeatures</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>mat_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSinglePPReference.html">SinglePPReference</a> &amp;&#160;</td>
          <td class="paramname"><em>ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>ref_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nthreads</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">nfeatures</td><td>Total number of features in the test dataset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mat_id</td><td>Offset to an integer array of length equal to <code>nfeatures</code>. Each element contains a feature identifier for the corresponding row. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ref</td><td>The reference dataset to use for annotation, see <code><a class="el" href="run__singlepp_8cpp.html#a5c22e638037333a0544e8176c25ac126">load_singlepp_reference()</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref_id</td><td>Offset to an integer array of length equal to the number of features in the reference dataset. This should contain the feature identifier for each feature in the reference, to be intersected with those in <code>mat_id</code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">top</td><td>Number of top markers to use. These features are taken from each pairwise comparison between labels.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <code><a class="el" href="classBuiltSinglePPReference.html" title="A built reference dataset for singlepp annotation.">BuiltSinglePPReference</a></code> object that can be immediately used for classification of any matrix with row identities corresponding to <code>mat_id</code>. </dd></dl>

</div>
</div>
<a id="a1507cbb26d4b4da36583bbe7821dda17" name="a1507cbb26d4b4da36583bbe7821dda17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1507cbb26d4b4da36583bbe7821dda17">&#9670;&nbsp;</a></span>integrate_singlepp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void integrate_singlepp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structNumericMatrix.html">NumericMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>assigned</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIntegratedSinglePPReferences.html">IntegratedSinglePPReferences</a> &amp;&#160;</td>
          <td class="paramname"><em>integrated</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>quantile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nthreads</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>Matrix containing the test dataset, with cells in columns and features in rows. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">assigned</td><td>Offset to an array of 64-bit pointers. This array should be of length <code>nref</code>, where each pointer corresponds to a reference. Each pointer should refer to an integer array of length equal to the number of cells in <code>mat</code>, where each value is the label assigned to a cell in the corresponding reference. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">integrated</td><td>An integrated set of reference datasets, see <code><a class="el" href="run__singlepp_8cpp.html#a0fcfba933b7bd26813e73a3089eb59af">integrate_singlepp_references()</a></code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">quantile</td><td>Quantile on the correlations to use when computing a score for each label. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Offset to an integer array of length equal to the number of columns in <code>mat</code>. This will be filled with the index of the reference with the top-scoring label for each cell in the test dataset.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>output</code> is filled with the reference indices. </dd></dl>

</div>
</div>
<a id="a0fcfba933b7bd26813e73a3089eb59af" name="a0fcfba933b7bd26813e73a3089eb59af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fcfba933b7bd26813e73a3089eb59af">&#9670;&nbsp;</a></span>integrate_singlepp_references()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntegratedSinglePPReferences.html">IntegratedSinglePPReferences</a> integrate_singlepp_references </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nfeatures</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>mat_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>refs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>ref_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>built</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nthreads</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">nfeatures</td><td>Total number of features in the test dataset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mat_id</td><td>Offset to an integer array of length equal to <code>nfeatures</code>. Each element contains a feature identifier for the corresponding row. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nref</td><td>Number of references. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">refs</td><td>Offset to an array of 64-bit pointers to <code><a class="el" href="classSinglePPReference.html" title="A reference dataset for singlepp annotation.">SinglePPReference</a></code> objects. This array should be of length <code>nref</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref_ids</td><td>Offset to an array of 64-bit pointers of length <code>nref</code>. Each entry points to an integer array of length equal to the number of features in the corresponding reference dataset. This should contain the feature identifier for each feature in the reference, to be intersected with those in <code>mat_id</code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">built</td><td>Offset to an array of 64-bit pointers to <code><a class="el" href="classBuiltSinglePPReference.html" title="A built reference dataset for singlepp annotation.">BuiltSinglePPReference</a></code> objects. This array should be of length <code>nref</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An <code><a class="el" href="classIntegratedSinglePPReferences.html" title="Integrated references for singlepp annotation.">IntegratedSinglePPReferences</a></code> object. </dd></dl>

</div>
</div>
<a id="a5c22e638037333a0544e8176c25ac126" name="a5c22e638037333a0544e8176c25ac126"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c22e638037333a0544e8176c25ac126">&#9670;&nbsp;</a></span>load_singlepp_reference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSinglePPReference.html">SinglePPReference</a> load_singlepp_reference </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>labels_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>labels_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>markers_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>markers_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>rankings_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>rankings_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">labels_buffer</td><td>Offset to an unsigned 8-bit integer array holding a Gzipped file of labels. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">labels_len</td><td>Length of the array in <code>labels_buffer</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">markers_buffer</td><td>Offset to an unsigned 8-bit integer array holding a Gzipped file of marker lists. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">markers_len</td><td>Length of the array in <code>markers_buffer</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rankings_buffer</td><td>Offset to an unsigned 8-bit integer array holding a Gzipped file with the ranking matrix. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">rankings_len</td><td>Length of the array in <code>rankings_buffer</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <code><a class="el" href="classSinglePPReference.html" title="A reference dataset for singlepp annotation.">SinglePPReference</a></code> object containing the reference dataset.</dd></dl>
<p>See the documentation at <a href="https://github.com/clusterfork/singlepp-references">https://github.com/clusterfork/singlepp-references</a> for details on the expected format of each file. </p>

</div>
</div>
<a id="a049321a0e89b028242b1aa3ad09bcc03" name="a049321a0e89b028242b1aa3ad09bcc03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a049321a0e89b028242b1aa3ad09bcc03">&#9670;&nbsp;</a></span>run_singlepp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void run_singlepp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structNumericMatrix.html">NumericMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBuiltSinglePPReference.html">BuiltSinglePPReference</a> &amp;&#160;</td>
          <td class="paramname"><em>built</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>quantile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nthreads</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>Matrix containing the test dataset, with cells in columns and features in rows. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">built</td><td>The pre-built reference dataset to use for annotation, see <code><a class="el" href="run__singlepp_8cpp.html#a9b596536ba8ab3238c77a32832c753d0">build_singlepp_reference()</a></code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">quantile</td><td>Quantile on the correlations to use when computing a score for each label. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Offset to an integer array of length equal to the number of columns in <code>mat</code>. This will be filled with the index of the assigned label for each cell in the test dataset.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>output</code> is filled with the label assignments from the reference dataset. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
